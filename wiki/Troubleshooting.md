# ุฑุงูููุง ุนุจโุงุจ

## ูุดฺฉูุงุช ุฑุงุฌ ู ุฑุงูโุญูโูุง

---

## ๐ฑ ูุดฺฉูุงุช ุงุญุฑุงุฒ ููุช ู SMS

### ูุดฺฉู: ฺฉุฏ OTP ุฏุฑุงูุช ููโุดูุฏ

**ููุงุด:** ุจุนุฏ ุงุฒ ูุงุฑุฏ ฺฉุฑุฏู ุดูุงุฑู ููุจุงูุ ูพุงูฺฉ ุฏุฑุงูุช ููโฺฉูุฏ.

**ุฑุงูโุญูโูุง:**

1. ุจุฑุฑุณ ุชูุธูุงุช Melipayamak
```bash
# ุจุฑุฑุณ .env
MELIPAYAMAK_USERNAME=your-username
MELIPAYAMAK_PASSWORD=your-password
```

2. ููุฌูุฏ ุญุณุงุจ Melipayamak
   - ุจู ูพูู Melipayamak ุจุฑูุฏ
   - ููุฌูุฏ ุญุณุงุจ ุฑุง ุจุฑุฑุณ ฺฉูุฏ
   - ุงฺฏุฑ ููุฌูุฏ ฺฉู ุงุณุชุ ุดุงุฑฺ ฺฉูุฏ

3. ุจุฑุฑุณ ฺฉุฏ ุงูฺฏู (Pattern Code)
   - ุฏุฑ ูพูู Melipayamakุ ฺฉุฏ ุงูฺฏู OTP ุฑุง ุจุฑุฑุณ ฺฉูุฏ
   - ูุทูุฆู ุดูุฏ ุฏุฑ ูุงู `.env` ุตุญุญ ูุงุฑุฏ ุดุฏู
   - ุงูฺฏู ุจุงุฏ ูุชุบุฑ `{verificationCode}` ุฑุง ุฏุงุดุชู ุจุงุดุฏ

4. ุดูุงุฑู ุงุฑุณุงูโฺฉููุฏู
   - ุดูุงุฑู Sender Number ุฏุฑ ูพูู Melipayamak ุฑุง ุจุฑุฑุณ ฺฉูุฏ
   - ูุทูุฆู ุดูุฏ ุดูุงุฑู ูุนุงู ุงุณุช
   - ุดูุงุฑู ุฑุง ุฏุฑ `.env` ูุงุฑุฏ ฺฉูุฏ

---

### ูุดฺฉู: OTP ูููุถ ุดุฏู ุงุณุช

**ููุงุด:** ูพุงู "ฺฉุฏ ุชุงุฏ ูุงูุนุชุจุฑ ุง ูููุถ ุดุฏู ุงุณุช"

**ุฑุงูโุญูโูุง:**

1. ุฏุฑุฎูุงุณุช OTP ุฌุฏุฏ ุจูุฑุณุชุฏ
2. ฺฉุฏ ุฌุฏุฏ ุฑุง ููุฑุงู ูุงุฑุฏ ฺฉูุฏ (ุฒุฑ 2 ุฏููู)
3. ุงฺฏุฑ ูุดฺฉู ุงุฏุงูู ุฏุงุดุชุ ุณุงุนุช ุณุฑูุฑ ุฑุง ุจุฑุฑุณ ฺฉูุฏ

---

### ูุดฺฉู: Rate limit ุดุฏู

**ููุงุด:** ูพุงู "ูุทูุงู ุจุนุฏ ุงุฒ X ุซุงูู ุชูุงุด ฺฉูุฏ"

**ุฑุงูโุญูโูุง:**

1. ุตุจุฑ ฺฉูุฏ ุชุง ุฒูุงู ุงูุชูุง ุจุฑุณุฏ
2. ุจุดุชุฑ ุงุฒ 3 ุฏุฑุฎูุงุณุช ุฏุฑ ูุฑ ุฏููู ููุฑุณุชุฏ
3. ุงฺฏุฑ Rate Limit ุงุดุชุจุงู ุงุณุชุ ุงุฏูู ุฑุง ุงุทูุงุน ุฏูุฏ

---

## ๐ณ ูุดฺฉูุงุช ูพุฑุฏุงุฎุช

### ูุดฺฉู: ุฏุฑฺฏุงู ูพุฑุฏุงุฎุช ุจุงุฒ ููโุดูุฏ

**ููุงุด:** ุจุนุฏ ุงุฒ ฺฉูฺฉ ุฑู "ูพุฑุฏุงุฎุช"ุ ฺุฒ ุงุชูุงู ููโุงูุชุฏ

**ุฑุงูโุญูโูุง:**

1. ุจุฑุฑุณ ุชูุธูุงุช ZarinPal
```bash
ZARINPAL_MERCHANT_ID=your-merchant-id
```

2. Merchant ID ุฑุง ุจุฑุฑุณ ฺฉูุฏ
   - ุจู ูพูู ZarinPal ุจุฑูุฏ
   - Merchant ID ุฑุง ฺฉูพ ฺฉูุฏ
   - ูุทูุฆู ุดูุฏ ุจุฏูู ูุงุตูู ู ฺฉุงูู ุงุณุช

3. Callback URL ุฑุง ุฏุฑ ูพูู ZarinPal ุชูุธู ฺฉูุฏ
   - ุจู https://zarinpal.com ุจุฑูุฏ
   - ูุงุฑุฏ ูพูู ูุฑฺูุช ุดูุฏ
   - Callback URL ุฑุง ุจู:
     ```
     https://your-domain.com/api/payment/verify
     ```
     ุง ุฏุฑ ุญุงูุช ุชูุณุนู:
     ```
     http://localhost:3000/api/payment/verify
     ```
     ุชูุธู ฺฉูุฏ

---

### ูุดฺฉู: ูพุฑุฏุงุฎุช ูุงูููู (ุฏุฑ ูพูู ZarinPal)

**ููุงุด:** ฺฉุงุฑุจุฑ ุฏุฑ ุฏุฑฺฏุงู ZarinPal ุจุง ุฎุทุง ููุงุฌู ูโุดูุฏ

**ุฑุงูโุญูโูุง:**

1. ูุจูุบ ูพุฑุฏุงุฎุช ุฑุง ุจุฑุฑุณ ฺฉูุฏ
   - ุจุงุฏ ุญุฏุงูู 10,000 ุฑุงู ุจุงุดุฏ
   - ุจุงุฏ ุนุฏุฏ ุตุญุญ ุจุงุดุฏ

2. ุจุฑุฑุณ ูุถุนุช ูุฑฺูุช
   - ูุฑฺูุช ูุนุงู ุจุงุดุฏ
   - ูุญุฏูุฏุชโูุง (ฺฉู/ุณูู) ุฑุง ุจุฑุฑุณ ฺฉูุฏ
   - ุงุญุฑุงุฒ ููุช ZarinPal ุงูุฌุงู ุดุฏู ุจุงุดุฏ

3. ุชุณุช ุฏุฑ Sandbox
   - ุฏุฑ ุญุงูุช ุชูุณุนูุ Sandbox ุฑุง ูุนุงู ฺฉูุฏ
   - ุฏุฑ `.env`:
     ```bash
     NODE_ENV=development
     ```

---

### ูุดฺฉู: callback URL ฺฉุงุฑ ููโฺฉูุฏ

**ููุงุด:** ุจุนุฏ ุงุฒ ูพุฑุฏุงุฎุช ููููุ ฺฉุงุฑุจุฑ ุจู ุตูุญู ุงุดุชุจุงู ูุฏุงุช ูโุดูุฏ

**ุฑุงูโุญูโูุง:**

1. NEXT_PUBLIC_BASE_URL ุฑุง ุจุฑุฑุณ ฺฉูุฏ
```bash
# ุฏุฑ .env
NEXT_PUBLIC_BASE_URL=https://your-domain.com
```

2. ูุทูุฆู ุดูุฏ:
   - ุจุฏูู `/` ุขุฎุฑ ุงุณุช
   - ูพุฑูุชฺฉู ุตุญุญ ุงุณุช (http/https)
   - ุฏุงููู ุฏุฑุณุช ุงุณุช

3. ุฏุฑ productionุ HTTPS ุฑุง ูุนุงู ฺฉูุฏ
   - Let's Encrypt ุฑุงฺฏุงู ุงุณุช
   - ุง ุงุฒ SSL provider ุงุณุชูุงุฏู ฺฉูุฏ

---

## ๐ซ ูุดฺฉูุงุช ูุฑุนูโฺฉุด

### ูุดฺฉู: ฺฉุฏ ูุฑุนูโฺฉุด ุชููุฏ ููโุดูุฏ

**ููุงุด:** ุจุนุฏ ุงุฒ ูพุฑุฏุงุฎุช ููููุ ฺฉุฏ ุฏุฑุงูุช ููโฺฉูุฏ

**ุฑุงูโุญูโูุง:**

1. ูุงฺฏ ุณุฑูุฑ ุฑุง ุจุฑุฑุณ ฺฉูุฏ
```bash
# ูุงฺฏโูุง ุฑุง ุจุจูุฏ
bun run dev
```

2. ูุงฺฏ ZarinPal ุฑุง ุจุฑุฑุณ ฺฉูุฏ
   - ุขุง `code: 100` ุจุฑฺฏุดุชุ
   - ุขุง `ref_id` ุฏุฑุงูุช ุดุฏูุ

3. ุฏุชุงุจุณ ุฑุง ุจุฑุฑุณ ฺฉูุฏ
```bash
# ุจุง Prisma Studio
bun run db:studio
```

4. ุชุฑุงฺฉูุดโูุง ูุงูููู ุฑุง ุฏุฑ logs ุจุจูุฏ

---

### ูุดฺฉู: ูุฑุนูโฺฉุด ุงุฌุฑุง ููโุดูุฏ

**ููุงุด:** ุฏฺฉูู "ุงูุฌุงู ูุฑุนูโฺฉุด" ฺฉุงุฑ ููโฺฉูุฏ

**ุฑุงูโุญูโูุง:**

1. ุธุฑูุช ูพุฑ ุดุฏู ุงุณุชุ
   - ุชุนุฏุงุฏ ฺฉุฏูุง >= ุธุฑูุชุ
   - ุงฺฏุฑ ุจููุ ูุถุนุช ุจุงุฏ CLOSED ุจุงุดุฏ

2. ฺฉุฏ ูุฑุนูโฺฉุด ูุนุชุจุฑ ูุฌูุฏ ุฏุงุฑุฏุ
   - ุฏุฑ ุฏุชุงุจุณุ `LotteryCode.count()`
   - ุญุฏุงูู ุจุงุฏ ฺฉ ฺฉุฏ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ

3. ุชูฺฉู ุงุฏูู ุตุญุญ ุงุณุชุ
   - `admin_token` ุฏุฑ `.env` ุฑุง ุจุฑุฑุณ ฺฉูุฏ
   - ุฏุฑ `/login` ุจุง ููุงู ุชูฺฉู ุชุณุช ฺฉูุฏ

---

## ๐๏ธ ูุดฺฉูุงุช ุฏุชุงุจุณ

### ูุดฺฉู: ุฏุชุงุจุณ ูุชุตู ููโุดูุฏ

**ููุงุด:** ุฎุทุง ุฏุฑ ุงุชุตุงู ุจู ุฏุชุงุจุณ

**ุฑุงูโุญูโูุง:**

1. `DATABASE_URL` ุฑุง ุจุฑุฑุณ ฺฉูุฏ
```bash
DATABASE_URL=file:./dev.db
```

2. ุฏุชุงุจุณ ุงุฌุงุฏ ุดุฏู ุงุณุชุ
```bash
# push schema
bun run db:push

# ุง ุจุง Prisma
bun prisma db push
```

3. ูุฌูุฒูุง ูุงู ุฑุง ุจุฑุฑุณ ฺฉูุฏ
```bash
# ุฏุฑ Linux/Mac
chmod 644 dev.db
```

4. ุฏุชุงุจุณ ุฑุง ุงูููโุณุงุฒ ฺฉูุฏ
```bash
bun scripts/init-db.ts
```

---

### ูุดฺฉู: ุฏุงุฏูโูุง ุฐุฎุฑู ููโุดููุฏ

**ููุงุด:** ุฏุฑุฎูุงุณุชโูุง ููููุช ุงูุง ุฏุชุงุจุณ ุฎุงู ุงุณุช

**ุฑุงูโุญูโูุง:**

1. Prisma Client ุฑุง ุจุงุฒุณุงุฒ ฺฉูุฏ
```bash
rm -rf node_modules/.prisma
bun run db:generate
```

2. ุจุฑุฑุณ ฺฉูุฏ ุขุง migration ุงุฌุฑุง ุดุฏู
```bash
bun prisma migrate status
```

3. Prisma Studio ุฑุง ุจุงุฒ ฺฉูุฏ
```bash
bun run db:studio
```

4. ูุงฺฏโูุง Prisma ุฑุง ุจุจูุฏ
   - ุฏุฑ routeุ `log: ['query']` ูุนุงู ุงุณุช

---

## ๐ง ูุดฺฉูุงุช Build/Deploy

### ูุดฺฉู: Build ุฎุทุง ูโุฏูุฏ

**ููุงุด:** ุฎุทุง ุฏุฑ `bun run build`

**ุฑุงูโุญูโูุง:**

1. ูุงุจุณุชฺฏโูุง ุฑุง ุฏูุจุงุฑู ูุตุจ ฺฉูุฏ
```bash
rm -rf node_modules bun.lockb
bun install
```

2. TypeScript errors ุฑุง ุจุฑุฑุณ ฺฉูุฏ
```bash
bun run build --dry-run
```

3. ESLint ุฑุง ุงุฌุฑุง ฺฉูุฏ
```bash
bun run lint
```

4. Cache ุฑุง ูพุงฺฉ ฺฉูุฏ
```bash
rm -rf .next
```

---

### ูุดฺฉู: ุฏุฑ Vercel Deploy ููโุดูุฏ

**ููุงุด:** ุฎุทุง ุฏุฑ ุงุณุชูุฑุงุฑ

**ุฑุงูโุญูโูุง:**

1. Environment Variables ุฑุง ุฏุฑ Vercel ุชูุธู ฺฉูุฏ
   - ุจู Dashboard ุจุฑูุฏ
   - Settings > Environment Variables
   - ุชูุงู ูุชุบุฑูุง `.env.example` ุฑุง ุงุถุงูู ฺฉูุฏ

2. Build Command ุฑุง ุจุฑุฑุณ ฺฉูุฏ
   - Settings > Build & Development
   - `bun run build`

3. Install Command ุฑุง ุจุฑุฑุณ ฺฉูุฏ
   - `bun install`

4. Prisma Schema ุฑุง ุจุฑุฑุณ ฺฉูุฏ
   - ุฏุฑ productionุ PostgreSQL ุจูุชุฑ ุงุณุช
   - DATABASE_URL ุฑุง ุจุฑุง PostgreSQL ุชูุธู ฺฉูุฏ

---

## ๐ ูุดฺฉูุงุช ุงููุช

### ูุดฺฉู: JWT token ฺฉุงุฑ ููโฺฉูุฏ

**ููุงุด:** ุฎุทุง 401 Unauthorized

**ุฑุงูโุญูโูุง:**

1. JWT_SECRET ุฑุง ุจุฑุฑุณ ฺฉูุฏ
```bash
JWT_SECRET=very-long-secure-random-string
```

2. token ุฑุง ุงุฒ cookies ุจุฑุฑุณ ฺฉูุฏ
```javascript
// ุฏุฑ browser console
document.cookie
```

3. token ุฑุง decode ฺฉูุฏ ุจุฑุง ุชุณุช
```bash
# ุจุง jwt.io ุง ุณุงุช ูุดุงุจู
```

4. ุฒูุงู ุณุฑูุฑ ููุงููฺฏ ุงุณุชุ
   - hour drift ููฺฉู ุงุณุช token ุฑุง ูุงูุนุชุจุฑ ฺฉูุฏ
   - NTP ุฑุง ุชูุธู ฺฉูุฏ

---

## ๐ ุฏุฑุฎูุงุณุช ฺฉูฺฉ

ุงฺฏุฑ ุฑุงูโุญู ูุดฺฉู ุฎูุฏ ุฑุง ูพุฏุง ูฺฉุฑุฏุฏ:

1. ฺฉ Issue ุจุงุฒ ฺฉูุฏ
   - https://github.com/Amirwopi/Shansix/issues/new
   - ุจุง template ููุงุณุจ

2. ุงุทูุงุนุงุช ุฒุฑ ุฑุง ุงุถุงูู ฺฉูุฏ:
   - ูุณุฎู: `1.0.0`
   - OS/Environment: ูุซุงู Ubuntu 20.04
   - ูุฑุงุญู ุชููุฏ ูุฌุฏุฏ
   - ุงุณฺฉุฑูโุดุงุช
   - ูุงฺฏโูุง ฺฉุงูู

3. ุง ูุณุชูู ุชูุงุณ ุจฺฏุฑุฏ:
   - ๐ง Email: amirwopi@gmail.com
   - ๐ฑ Telegram: @amirwopi

---

## ๐ ููฺฉโูุง ููุฏ

- [GitHub Issues](https://github.com/Amirwopi/Shansix/issues)
- [Documentation](https://github.com/Amirwopi/Shansix/wiki)
- [Melipayamak Docs](https://melipayamak.com)
- [ZarinPal Docs](https://www.zarinpal.com/docs)
